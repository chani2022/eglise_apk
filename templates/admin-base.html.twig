<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Welcome!
			{% endblock %}
		</title>

		<!--a supprimer-->
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/js/jquery.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/bootstrap/js/popper.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/bootstrap/js/bootstrap.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/bootstrap-select/bootstrap-select.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/bootstrap-touchspin/jquery.bootstrap-touchspin.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/magnific-popup/magnific-popup.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/counter/waypoints-min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/counter/counterup.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/imagesloaded/imagesloaded.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/masonry/masonry.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/masonry/filter.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/owl-carousel/owl.carousel.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/scroll/scrollbar.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/js/functions.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/chart/chart.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/js/admin.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/calendar/moment.min.js') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/calendar/fullcalendar.min.js') }}">
		<!--a supprimer-->

		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/css/assets.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/calendar/fullcalendar.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/css/typography.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/css/shortcodes/shortcodes.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/css/style.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/css/dashboard.css') }}">
		<!--link class="skin" rel="stylesheet" type="text/css" href="{{ asset('assets/css/color/color-1.css') }}"-->
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/summernote/summernote.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ asset('admin/assets/vendors/file-upload/imageuploadify.min.css') }}">
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>
		<link rel="shortcut icon" type="image/x-icon" href="{{ asset('assets/images/favicon.png') }}"/>

		<link rel="stylesheet" type="text/css" href="{{ asset('assets/css/iconstyle.css') }}">


		{# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
		{% block stylesheets %}
			{# {{ encore_entry_link_tags('app') }} #}
		{% endblock %}

		{% block javascripts %}
			{# javascript file #}
			<script src="{{ asset('assets/js/jquery.min.js') }}"></script>
			<script src="{{ asset('assets/vendors/bootstrap/js/popper.min.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/bootstrap/js/bootstrap.min.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/bootstrap-select/bootstrap-select.min.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/bootstrap-touchspin/jquery.bootstrap-touchspin.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/magnific-popup/magnific-popup.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/counter/waypoints-min.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/counter/counterup.min.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/imagesloaded/imagesloaded.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/masonry/masonry.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/masonry/filter.js') }}" defer></script>
			<script src="{{ asset('assets/vendors/owl-carousel/owl.carousel.js') }}" defer></script>
			<script src="{{ asset('admin/assets/vendors/scroll/scrollbar.min.js') }}" defer></script>
			<script src="{{ asset('assets/js/functions.js') }}" defer></script>
			<script src="{{ asset('admin/assets/vendors/chart/chart.min.js') }}" defer></script>
			<script src="{{ asset('admin/assets/js/admin.js') }}" defer></script>
			<!-- Revolution JavaScripts Files -->
			<script src="{{ asset('admin/assets/vendors/calendar/moment.min.js') }}" defer></script>
			<!-- Slider revolution 5.0 Extensions  (Load Extensions only on Local File Systems !  The following part can be removed on Server for On Demand Loading) -->
			<script src="{{ asset('admin/assets/vendors/calendar/fullcalendar.js') }}" defer></script>
			<script src="{{ asset('admin/assets/vendors/summernote/summernote.js') }}" defer></script>
			<script src="{{ asset('admin/assets/vendors/file-upload/imageuploadify.min.js') }}" defer></script>
			<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.1.1/dist/chartjs-adapter-moment.min.js"></script>


			<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
			{# {{ encore_entry_script_tags('app') }} #}
		{% endblock %}
	</head>
	<body>
		<div class="info-socket" data-user-id="{{ app.user ? app.user.getId(): null }}" data-id-remove="{{ app.session.get('idArticleToRemoveInArticleRecent') ? app.session.get('idArticleToRemoveInArticleRecent') : null }}"></div>
		<div class="ttr-opened-sidebar ttr-pinned-sidebar">
			{{ include ('menu/admin/header.html.twig') }}
			
			{{ include ('menu/admin/siderbar.html.twig') }}


			<main class="ttr-wrapper"> {% block body %}{% endblock %}
				</main>

				<div class="ttr-overlay"></div>
			</div>
			<script>
				$(document).ready(function () {

$('#calendar').fullCalendar({
header: {
left: 'prev,next today',
center: 'title',
right: 'month,agendaWeek,agendaDay,listWeek'
},
defaultDate: '2019-03-12',
navLinks: true, // can click day/week names to navigate views

weekNumbers: true,
weekNumbersWithinDays: true,
weekNumberCalculation: 'ISO',

editable: true,
eventLimit: true, // allow "more" link when too many events
events: [
{
title: 'All Day Event',
start: '2019-03-01'
},
{
title: 'Long Event',
start: '2019-03-07',
end: '2019-03-10'
},
{
id: 999,
title: 'Repeating Event',
start: '2019-03-09T16:00:00'
},
{
id: 999,
title: 'Repeating Event',
start: '2019-03-16T16:00:00'
}, {
title: 'Conference',
start: '2019-03-11',
end: '2019-03-13'
}, {
title: 'Meeting',
start: '2019-03-12T10:30:00',
end: '2019-03-12T12:30:00'
}, {
title: 'Lunch',
start: '2019-03-12T12:00:00'
}, {
title: 'Meeting',
start: '2019-03-12T14:30:00'
}, {
title: 'Happy Hour',
start: '2019-03-12T17:30:00'
}, {
title: 'Dinner',
start: '2019-03-12T20:00:00'
}, {
title: 'Birthday Party',
start: '2019-03-13T07:00:00'
}, {
title: 'Click for Google',
url: 'http://google.com/',
start: '2019-03-28'
}
]
});

});
			</script>

<script>
	// Récupérer les données de Twig
	var data = {{ usersWithArticles|json_encode()|raw }};
	console.log("Mon data admin",data)
	// Initialiser les tableaux pour les étiquettes et les données du graphique
	var colorPalette = [
        'rgba(255, 99, 132, 0.7)',
        'rgba(54, 162, 235, 0.7)',
        'rgba(255, 206, 86, 0.7)',
        'rgba(75, 192, 192, 0.7)',
        'rgba(153, 102, 255, 0.7)',
        // Ajoutez plus de couleurs ici si nécessaire
    ];

    // Initialiser les tableaux pour les étiquettes et les données du graphique
    var labels = [];
    var datasetsData = [];
    var backgroundColors = [];

	// Parcourir les données d'utilisateur et d'articles
	for (var userId in data) {
            if (data.hasOwnProperty(userId)) {
                var user = data[userId];
                labels.push(user.nom + ' ' + user.prenom);

                // Compter le nombre d'articles pour cet utilisateur
                var numArticles = Object.keys(user.articles).length;
                datasetsData.push(numArticles);

				// Générer une couleur aléatoire à partir de la palette
				var randomColor = colorPalette[Math.floor(Math.random() * colorPalette.length)];
            backgroundColors.push(randomColor);
            }
        }

	// Configuration du graphique
	var ctx = document.getElementById('chart2').getContext('2d');
	ctx.canvas.width = 200; // Largeur du canvas en pixels
    ctx.canvas.height = 200; // Hauteur du canvas en pixels
	console.log(ctx)
	var myChart = new Chart(ctx, {
		type: 'pie',
		data: {
			labels: labels,
			datasets: [{
				label: 'Nombre d\'articles',
				data: datasetsData,
				backgroundColor: backgroundColors,
				borderColor: 'rgba(75, 192, 192, 1)',
				borderWidth: 1
			}]
		},
		options: {
			scales: {
				y: {
					beginAtZero: true
				}
			}
		}
	});
</script>


<script>
	// Récupérer les données de Twig
	
	var data = {{ usersWithArticles|json_encode()|raw }};
	console.log("data redac",data)
	// Initialiser les tableaux pour les étiquettes et les données du graphique
	var colorPalette = [
        'rgba(255, 99, 132, 0.7)',
        'rgba(54, 162, 235, 0.7)',
        'rgba(255, 206, 86, 0.7)',
        'rgba(75, 192, 192, 0.7)',
        'rgba(153, 102, 255, 0.7)',
        // Ajoutez plus de couleurs ici si nécessaire
    ];

    // Initialiser les tableaux pour les étiquettes et les données du graphique
    var labels = [];
    var datasetsData = [];
    var backgroundColors = [];

	// Parcourir les données d'utilisateur et d'articles
	for (var userId in data) {
            if (data.hasOwnProperty(userId)) {
                var user = data[userId];
                labels.push(user.prenom);

                // Compter le nombre d'articles pour cet utilisateur
                var numArticles = Object.keys(user.articles).length;
                datasetsData.push(numArticles);

				// Générer une couleur aléatoire à partir de la palette
				var randomColor = colorPalette[Math.floor(Math.random() * colorPalette.length)];
            backgroundColors.push(randomColor);
            }
        }

	// Configuration du graphique
	var ctx = document.getElementById('chart_user').getContext('2d');
	ctx.canvas.width = 200; // Largeur du canvas en pixels
    ctx.canvas.height = 200; // Hauteur du canvas en pixels
	console.log(ctx)
	var myChart = new Chart(ctx, {
		type: 'doughnut',
		data: {
			labels: labels,
			datasets: [{
				label: 'Nombre d\'articles',
				data: datasetsData,
				backgroundColor: backgroundColors,
				borderColor: 'rgba(75, 192, 192, 1)',
				borderWidth: 1
			}]
		},
		options: {
			scales: {
				y: {
					beginAtZero: true
				}
			}
		}
	});
</script>
<script>
	console.log("Eto tsika zao",data2);
	var colorPalette = [
        'rgba(255, 99, 132, 0.7)',
        'rgba(54, 162, 235, 0.7)',
        'rgba(255, 206, 86, 0.7)',
        'rgba(75, 192, 192, 0.7)',
        'rgba(153, 102, 255, 0.7)',
        // Ajoutez plus de couleurs ici si nécessaire
    ];


   // Initialiser les tableaux pour les étiquettes et les données du graphique
   var articlesParDate = {};

// Parcourir les données d'articles
for (var i = 0; i < data2.length; i++) {
    var article = data2[i];
    var date = article.created_at.split(' ')[0]; // Récupérer la date sans l'heure
    
    if (!articlesParDate[date]) {
        articlesParDate[date] = 1;
    } else {
        articlesParDate[date]++;
    }
}

var labels = [];
var datasetsData = [];
var backgroundColors = [];

// Parcourir les articles par date pour préparer les données du graphique
for (var date in articlesParDate) {
    if (articlesParDate.hasOwnProperty(date)) {
        labels.push(date);
        datasetsData.push(articlesParDate[date]);
        
        // Générer une couleur aléatoire pour chaque point de données
        var randomColor = 'rgba(' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ', 0.6)';
        backgroundColors.push(randomColor);
    }
}

// Configuration du graphique
var ctx = document.getElementById('chart_redac_2').getContext('2d');
ctx.canvas.width = 800; // Largeur du canvas en pixels
ctx.canvas.height = 400; // Hauteur du canvas en pixels

var myChart = new Chart(ctx, {
    type: 'bar', // Utilisation d'un graphique en ligne pour afficher la courbe
    data: {
        labels: labels,
        datasets: [{
            label: 'Nombre d\'articles par jour',
            data: datasetsData, // Utilisation du tableau datasetsData pour les données
            borderColor: 'rgba(75, 192, 192, 1)', // Couleur de la ligne
            borderWidth: 2, // Épaisseur de la ligne
            fill: true, // Remplir l'aire sous la courbe
            tension: 0.4, // Ajustez la tension pour obtenir une forme sinusoidale
            backgroundColor: 'rgba(75, 192, 192, 0.2)' // Couleur de remplissage de l'aire sous la courbe
        }]
    },
    options: {
        scales: {
            x: {
                beginAtZero: true, // Si vous voulez que l'axe X commence à zéro
                title: {
                    display: true,
                    text: 'Date de création'
                }
            },
            y: {
                beginAtZero: true, // Si vous voulez que l'axe Y commence à zéro
                title: {
                    display: true,
                    text: 'Nombre d\'articles'
                }
            }
        }
    }
});



</script>
		</body>
	</html>
